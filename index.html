<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Controle de Pagamentos - Sistema Online</title>
    <meta name="description" content="Sistema web para controle e gest√£o de pagamentos com interface moderna">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%231f6feb%22>üí∞</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%231f6feb%22>üí∞</text></svg>">
    
    <!-- Open Graph para redes sociais -->
    <meta property="og:title" content="Controle de Pagamentos">
    <meta property="og:description" content="Sistema web para controle de pagamentos">
    <meta property="og:type" content="website">
    
    <!-- Bibliotecas externas -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>

    <!-- Estilos locais -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
   <div class="container">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; flex-wrap: wrap; gap: 10px;">
        <h1 style="margin: 0;">Controle de Pagamentos</h1>
        <button id="btn-toggle-darkmode" class="darkmode-toggle" title="Alternar modo escuro/claro">
            üåô
        </button>
    </div>
    <!-- ... resto do c√≥digo continua igual ... -->
</div>

        <!-- Registro de Pagamento -->
        <div class="card">
            <strong>Registrar Pagamento</strong>
            <div class="grid" style="margin-top:8px">
                <div>
                    <label for="input-nome">Nome</label>
                    <input id="input-nome" type="text" placeholder="Ex.: Jo√£o Silva" list="datalist-nomes" autocomplete="off">
                    <datalist id="datalist-nomes"></datalist>
                </div>
                <div><label for="input-data">Data</label><input id="input-data" type="date"></div>
                <div><label for="input-valor">Valor (R$)</label><input id="input-valor" type="number" step="0.01" placeholder="1000.00"></div>
                <div><label for="input-historico">Hist√≥rico</label><input id="input-historico" type="text" placeholder="Descri√ß√£o"></div>
            </div>
            <div style="margin-top:10px;display:flex;gap:8px">
                <button id="btn-registrar">Registrar</button>
                <button id="btn-limpar" class="secondary">Limpar</button>
                <button id="btn-save-close" class="danger" title="Gera backup CSV/XLSX e fecha o programa">Salvar e Fechar</button>
                <div style="margin-left:auto"><small class="note">Dados salvos localmente no navegador (localStorage).</small></div>
            </div>
        </div>

      <!-- Backup e Sincroniza√ß√£o -->
<div class="card">
    <strong>üíæ Backup e Sincroniza√ß√£o</strong>
    <div style="margin-top:8px">
        <div style="display: flex; gap: 8px; flex-wrap: wrap; align-items: center;">
            <!-- Backup Local -->
            <button id="btn-backup-local" class="success">üíæ Backup Local</button>
            <button id="btn-restore-local" class="secondary">üì• Restaurar Local</button>
            
            <!-- Separador visual -->
            <div style="width: 1px; height: 30px; background: #ddd; margin: 0 8px;"></div>
            
            <!-- Google Drive (Opcional) -->
            <small style="color: #666; margin-right: 8px;">Google Drive (opcional):</small>
            <button id="btn-google-login" class="secondary">
                <span id="google-status">üîì Conectar</span>
            </button>
            <button id="btn-backup-drive" class="secondary" disabled>‚òÅÔ∏è Backup Drive</button>
            <button id="btn-restore-drive" class="secondary" disabled>üì• Restaurar Drive</button>
            <button id="btn-logout-drive" class="secondary" disabled>üö™ Sair</button>
            
            <div style="margin-left: auto;">
                <small class="note" id="drive-status">Backup local dispon√≠vel</small>
            </div>
        </div>
        
        <!-- Informa√ß√µes sobre as op√ß√µes -->
        <div style="margin-top: 10px; padding: 8px; background: #f8f9fa; border-radius: 4px;">
            <small style="color: #666;">
                <strong>üí° Op√ß√µes de backup:</strong><br>
                ‚Ä¢ <strong>Local:</strong> Salva arquivos no seu computador (sempre dispon√≠vel)<br>
                ‚Ä¢ <strong>Google Drive:</strong> Sincroniza na nuvem (opcional, requer login)
            </small>
        </div>
    </div>
</div>

        <!-- Filtros -->
        <div class="card">
            <strong>Filtros</strong>
            <div class="grid" style="margin-top:8px">
                <div>
                    <label for="filtro-nome">Nome (selecionar)</label>
                    <select id="filtro-nome" style="width:100%">
                        <option value="">-- Todos --</option>
                    </select>
                </div>
                <div><label for="filtro-di">Data inicial</label><input id="filtro-di" type="date"></div>
                <div><label for="filtro-df">Data final</label><input id="filtro-df" type="date"></div>
                <div><label>&nbsp;</label>
                    <div style="display:flex;gap:8px">
                        <button id="btn-aplicar-filtros">Aplicar Filtros</button>
                        <button id="btn-limpar-filtros" class="secondary">Limpar Filtros</button>
                    </div>
                </div>
            </div>
        </div>

       <!-- Gr√°ficos -->
<div class="card" id="card-graficos">
    <strong>Gr√°ficos</strong>
    <div class="charts">
        <div><canvas id="chart-nomes" height="300" role="img" aria-label="Gr√°fico de totais por nome"></canvas></div>
        <div><canvas id="chart-meses" height="300" role="img" aria-label="Gr√°fico de totais por m√™s"></canvas></div>
    </div>
    <div style="margin-top:10px;display:flex;gap:8px">
        <!-- REMOVIDO: <button id="btn-atualizar-graficos">Atualizar Gr√°ficos (com filtros)</button> -->
        <button id="btn-relatorio-mes" class="secondary">Relat√≥rio (PDF)</button>
        <button id="btn-relatorio-ano" class="secondary">Relat√≥rio Anual (PDF)</button>
        <button id="btn-reset" class="secondary" style="margin-left:auto">Resetar todos os dados</button>
    </div>
</div>

       <!-- Registros (colaps√°vel) -->
<div class="card" id="card-registros-externo" style="margin-top:0">
    <div style="display:flex;align-items:center">
        <strong>Registros</strong>
        <button type="button" id="btn-toggle-registros" class="collapse-btn" aria-expanded="true" style="margin-left:18px">
            <span id="btn-toggle-text">Recolher</span>
        </button>
        <div class="right controls">
            <button id="btn-export-csv" class="secondary">Exportar CSV (filtrados)</button>
            <button id="btn-export-xlsx" class="secondary">Exportar XLSX (filtrados)</button>
            <label style="margin-left:8px">
                <input id="file-import" type="file" accept=".csv" style="display:none">
                <button id="btn-import-csv" class="secondary">Importar CSV</button>
            </label>
        </div>
    </div>
    <div id="card-registros-collapsible" class="card-collapsible">
        <div class="table-wrap">
            <table id="tbl-registros" role="grid" aria-label="Lista de pagamentos">
                <thead>
                    <tr><th>ID</th><th>Nome</th><th>Data</th><th style="text-align:right">Valor (R$)</th><th>Hist√≥rico</th><th>A√ß√µes</th></tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="summary" id="resumo-total">Total: R$ 0,00</div>
    </div>
</div>

        <!-- Di√°logo de restaura√ß√£o de backup -->
        <div id="backup-restore-dialog" style="display:none;">
            <div id="backup-restore-content">
                <h2>Restaurar backup?</h2>
                <p>Deseja carregar um backup para restaurar os registros anteriores?</p>
                <input id="restore-file-input" type="file" accept=".csv,.xlsx">
                <div style="margin-top:12px">
                    <button id="btn-restore-ok">Restaurar backup</button>
                    <button id="btn-restore-cancel" class="secondary">N√£o restaurar</button>
                </div>
            </div>
        </div>

        <!-- Toast Notifications -->
        <div id="toast-container" class="toast-container"></div>
    </div>

   <!-- Scripts locais -->
<script src="js/utils.js"></script>
<script src="js/eventBus.js"></script>
<script src="js/dataManager.js"></script>
<script src="js/exportManager.js"></script>
<script src="js/googleDriveManager.js"></script>
<script src="js/darkModeManager.js"></script> <!-- NOVO -->
<script src="js/uiComponents.js"></script>
<script src="js/app.js"></script>
</body>
</html>