<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle de Combust√≠vel - Frota</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Header Fixo -->
    <header class="main-header">
        <button onclick="voltarAoMenu()" class="back-button">
            ‚¨ÖÔ∏è Voltar ao Menu Principal
        </button>
        
        <span class="system-name">
            <span id="nome-sistema">Controle de Combust√≠veis</span>
        </span>
    </header>

    <!-- Bot√£o de Tema -->
    <button class="theme-toggle" id="theme-toggle">üåô</button>

    <!-- Conte√∫do Principal -->
    <div class="main-content">
        <div class="container">
            <header class="page-header">
                <h1>Controle de Combust√≠vel - Frota</h1>
                <p class="description">Controle os gastos com combust√≠vel de sua frota de ve√≠culos</p>
            </header>
            
            <div class="tabs">
                <div class="tab active" data-tab="visao-geral">Vis√£o Geral</div>
                <div class="tab" data-tab="veiculos">Ve√≠culos</div>
                <div class="tab" data-tab="abastecimentos">Abastecimentos</div>
                <div class="tab" data-tab="graficos">Gr√°ficos</div>
                <div class="tab" data-tab="backup">Backup</div> <!-- NOVA ABA -->
            </div>            

            <!-- VIS√ÉO GERAL -->
            <div class="tab-content active" id="visao-geral">
                <section class="dashboard">
                    <div class="card">
                        <h3>Total Gasto na Frota</h3>
                        <div class="card-value total" id="total-frota">R$ 0,00</div>
                    </div>
                    <div class="card">
                        <h3>Total de Ve√≠culos</h3>
                        <div class="card-value veiculos" id="total-veiculos">0</div>
                    </div>
                    <div class="card">
                        <h3>M√©dia por Litro</h3>
                        <div class="card-value" id="media-litro-frota">R$ 0,00</div>
                    </div>
                    <div class="card">
                        <h3>Total de Litros</h3>
                        <div class="card-value" id="total-litros-frota">0 L</div>
                    </div>
                </section>
                
                <section class="table-container">
                    <h2 class="form-title">Resumo por Ve√≠culo</h2>
                    <table id="tabela-resumo-veiculos">
                        <thead>
                            <tr>
                                <th>Ve√≠culo</th>
                                <th>Placa</th>
                                <th>Total Gasto</th>
                                <th>Litros</th>
                                <th>M√©dia R$/L</th>
                                <th>√öltimo Abastecimento</th>
                            </tr>
                        </thead>
                        <tbody id="tabela-resumo-corpo">
                            <!-- Os dados ser√£o inseridos aqui via JavaScript -->
                        </tbody>
                    </table>
                    <div id="empty-resumo" class="empty-message">
                        Nenhum ve√≠culo cadastrado ainda.
                    </div>
                </section>
            </div>
            
            <!-- VE√çCULOS -->
            <div class="tab-content" id="veiculos">
                <section class="form-container">
                    <h2 class="form-title">Cadastrar Ve√≠culo</h2>
                    <form id="veiculo-form">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="nome-veiculo">Nome do Ve√≠culo</label>
                                <input type="text" id="nome-veiculo" required>
                            </div>
                            <div class="form-group">
                                <label for="placa">Placa</label>
                                <input type="text" id="placa" required>
                            </div>
                            <div class="form-group">
                                <label for="tipo-veiculo">Tipo de Ve√≠culo</label>
                                <select id="tipo-veiculo" required>
                                    <option value="">Selecione</option>
                                    <option value="ambulancia">Ambul√¢ncia</option>
                                    <option value="carro">Carro</option>
                                    <option value="moto">Moto</option>
                                    <option value="caminhao">Caminh√£o</option>
                                    <option value="van">Van</option>
                                    <option value="onibus">√înibus</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="combustivel-padrao">Combust√≠vel Padr√£o</label>
                                <select id="combustivel-padrao" required>
                                    <option value="">Selecione</option>
                                    <option value="gasolina">Gasolina</option>
                                    <option value="etanol">Etanol</option>
                                    <option value="diesel">Diesel</option>
                                    <option value="gnv">GNV</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <button type="submit">Cadastrar Ve√≠culo</button>
                            <button type="button" id="btn-limpar-veiculo" class="btn-danger">Limpar Campos</button>
                        </div>
                    </form>
                </section>
                
                <section class="table-container">
                    <h2 class="form-title">Ve√≠culos Cadastrados</h2>
                    <table id="tabela-veiculos">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Placa</th>
                                <th>Tipo</th>
                                <th>Combust√≠vel</th>
                                <th>Total Gasto</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="tabela-veiculos-corpo">
                            <!-- Os dados ser√£o inseridos aqui via JavaScript -->
                        </tbody>
                    </table>
                    <div id="empty-veiculos" class="empty-message">
                        Nenhum ve√≠culo cadastrado ainda.
                    </div>
                </section>
            </div>
            
<!-- ABASTECIMENTOS -->
<div class="tab-content" id="abastecimentos">
    <section class="form-container">
        <h2 class="form-title">Registrar Abastecimento</h2>
        <div class="help-text">
            <small>üí° <strong>Como preencher:</strong> Informe quaisquer DOIS valores que o sistema calcular√° o terceiro automaticamente.</small>
            <br>
            <small>Exemplos: Litros + Pre√ßo/L ‚Üí calcula Total | Total + Pre√ßo/L ‚Üí calcula Litros | Total + Litros ‚Üí calcula Pre√ßo/L</small>
        </div>
        
        <form id="abastecimento-form">
            <div class="form-grid">
                <div class="form-group">
                    <label for="veiculo">Ve√≠culo</label>
                    <select id="veiculo" required>
                        <option value="">Selecione um ve√≠culo</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="data">Data</label>
                    <input type="date" id="data" required>
                </div>
                <div class="form-group">
                    <label for="combustivel">Tipo de Combust√≠vel</label>
                    <select id="combustivel" required>
                        <option value="">Selecione</option>
                        <option value="gasolina">Gasolina</option>
                        <option value="etanol">Etanol</option>
                        <option value="diesel">Diesel</option>
                        <option value="gnv">GNV</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="litros">Litros</label>
                    <input type="number" id="litros" step="0.01" min="0" required>
                </div>
                <div class="form-group">
                    <label for="preco-litro">Pre√ßo por Litro (R$)</label>
                    <input type="number" id="preco-litro" step="0.001" min="0" required>
                </div>
                <div class="form-group">
                    <label for="valor-total">Valor Total (R$)</label>
                    <input type="number" id="valor-total" step="0.01" min="0" required>
                </div>
                <div class="form-group">
                    <label for="odometro">Od√¥metro (km)</label>
                    <input type="number" id="odometro" min="0">
                </div>
            </div>
            <div class="form-group">
                <button type="submit">Adicionar Abastecimento</button>
                <button type="button" id="btn-limpar" class="btn-danger">Limpar Campos</button>
            </div>
        </form>
    </section>
    
    <section class="table-container">
        <h2 class="form-title">Hist√≥rico de Abastecimentos</h2>
        <div class="filtro-veiculo">
            <label for="filtro-veiculo-abastecimentos">Filtrar por ve√≠culo:</label>
            <select id="filtro-veiculo-abastecimentos">
                <option value="todos">Todos os ve√≠culos</option>
            </select>
        </div>
        <table id="tabela-abastecimentos">
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Ve√≠culo</th>
                    <th>Combust√≠vel</th>
                    <th>Litros</th>
                    <th>Pre√ßo/L (R$)</th>
                    <th>Total (R$)</th>
                    <th>Od√¥metro (km)</th>
                    <th>A√ß√µes</th>
                </tr>
            </thead>
            <tbody id="tabela-corpo">
                <!-- Os dados ser√£o inseridos aqui via JavaScript -->
            </tbody>
        </table>
        <div id="empty-message" class="empty-message">
            Nenhum abastecimento registrado ainda.
        </div>
    </section>
</div>            
            <!-- GR√ÅFICOS -->
<div class="tab-content" id="graficos">
    <!-- FILTRO AVAN√áADO -->
    <section class="form-container">
        <h2 class="form-title">Filtros Avan√ßados</h2>
        <div class="form-grid">
            <div class="form-group">
                <label for="filtro-veiculo-graficos">Filtrar por Ve√≠culo</label>
                <select id="filtro-veiculo-graficos" multiple size="4">
                    <option value="todos" selected>Todos os Ve√≠culos</option>
                </select>
                <small>Segure Ctrl para selecionar m√∫ltiplos ve√≠culos</small>
            </div>
            <div class="form-group">
                <label for="filtro-data-inicio">Data In√≠cio</label>
                <input type="date" id="filtro-data-inicio">
            </div>
            <div class="form-group">
                <label for="filtro-data-fim">Data Fim</label>
                <input type="date" id="filtro-data-fim">
            </div>
            <div class="form-group">
                <label for="filtro-combustivel">Tipo de Combust√≠vel</label>
                <select id="filtro-combustivel" multiple size="3">
                    <option value="todos" selected>Todos</option>
                    <option value="gasolina">Gasolina</option>
                    <option value="etanol">Etanol</option>
                    <option value="diesel">Diesel</option>
                    <option value="gnv">GNV</option>
                </select>
            </div>
        </div>
        <div class="form-group">
            <button type="button" id="btn-aplicar-filtros" class="btn-warning">Aplicar Filtros</button>
            <button type="button" id="btn-limpar-filtros" class="btn-danger">Limpar Filtros</button>
        </div>
    </section>

    <section class="charts-container">
        <div class="chart-card">
            <h3 class="chart-title">Gastos por Ve√≠culo</h3>
            <canvas id="grafico-gastos-veiculos"></canvas>
        </div>
        <div class="chart-card">
            <h3 class="chart-title">Distribui√ß√£o por Combust√≠vel</h3>
            <canvas id="grafico-combustivel"></canvas>
        </div>
        <div class="chart-card">
            <h3 class="chart-title">Evolu√ß√£o de Gastos Mensais</h3>
            <canvas id="grafico-evolucao-gastos"></canvas>
        </div>
        <div class="chart-card">
            <h3 class="chart-title">Compara√ß√£o de M√©dias por Ve√≠culo</h3>
            <canvas id="grafico-medias-veiculos"></canvas>
        </div>
    </section>
</div>
        </div>

        <!-- BACKUP -->
<div class="tab-content" id="backup">
    <section class="form-container">
        <h2 class="form-title">Backup dos Dados</h2>
        <p>Fa√ßa backup de todos os seus dados ou restaure de um backup anterior.</p>
        
        <div class="form-grid">
            <div class="form-group">
                <h3>Exportar Dados</h3>
                <p>Fa√ßa download de todos os dados atuais em formato JSON.</p>
                <button type="button" id="btn-exportar" class="btn-warning">Exportar Backup</button>
            </div>
            
            <div class="form-group">
                <h3>Importar Dados</h3>
                <p>Restore dados de um backup anterior. <strong>Aten√ß√£o:</strong> Isso substituir√° todos os dados atuais.</p>
                <input type="file" id="arquivo-backup" accept=".json" style="margin-bottom: 10px;">
                <button type="button" id="btn-importar" class="btn-danger">Importar Backup</button>
            </div>
        </div>
    </section>

    <section class="form-container">
        <h2 class="form-title">Informa√ß√µes do Sistema</h2>
        <div class="veiculo-stats">
            <div class="stat-item">
                <div class="stat-value" id="info-veiculos">0</div>
                <div class="stat-label">Ve√≠culos Cadastrados</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="info-abastecimentos">0</div>
                <div class="stat-label">Abastecimentos</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="info-total-gasto">R$ 0,00</div>
                <div class="stat-label">Total Gasto</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="info-ultimo-backup">-</div>
                <div class="stat-label">√öltimo Backup</div>
            </div>
        </div>
    </section>

    <section class="form-container">
        <h2 class="form-title">Limpeza de Dados</h2>
        <p class="warning-text">‚ö†Ô∏è <strong>Aten√ß√£o:</strong> Estas a√ß√µes s√£o irrevers√≠veis!</p>
        
        <div class="form-group">
            <button type="button" id="btn-limpar-tudo" class="btn-danger">Limpar TODOS os Dados</button>
            <small>Remove todos os ve√≠culos e abastecimentos</small>
        </div>
    </section>
</div>
    </div>

    <script src="script.js"></script>
    <script>
    function voltarAoMenu() {
        // Navega√ß√£o inteligente que funciona em qualquer ambiente
        if (window.location.pathname.includes('/sistema-financeiro/') || 
            window.location.pathname.includes('/sistema-combustiveis/')) {
            window.location.href = '../index.html';
        } else {
            window.location.href = './index.html';
        }
    }

    // Opcional: Detecta qual sistema est√° rodando
    if (window.location.pathname.includes('combustiveis') || 
        document.title.includes('Combust√≠vel')) {
        document.getElementById('nome-sistema').textContent = 'Controle de Combust√≠veis';
    }
    </script>
</body>
</html>